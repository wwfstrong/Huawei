parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"OCOi":[function(require,module,exports) {
"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=function e(n){if(t(this,e),!n)throw new Error("需要传递需要绑定的DOM元素");var o,i,r,c="string"==typeof n?document.querySelector(n):n,u={swipLeft:[],swipRight:[]};c.ontouchstart=function(t){o=t.changedTouches[0].pageX},c.ontouchmove=function(t){r&&clearTimeout(r),r=setTimeout(function(){(i=t.changedTouches[0].pageX)-o>10?u.swipRight.forEach(function(t){return t.bind(c)()}):i-o<10&&u.swipLeft.forEach(function(t){return t.bind(c)()})},100)},this.on=function(t,e){u[t]&&u[t].push(e)},this.off=function(t,e){var n=u[t].indexOf(e);-1!==n&&u[t].splice(n,1)}},n=e;exports.default=n;
},{}],"EWR2":[function(require,module,exports) {
"use strict";var t=e(require("./swiper.js"));function e(t){return t&&t.__esModule?t:{default:t}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function r(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}var s=function(){function e(t){var n=this;i(this,e),this.root="string"==typeof t?document.querySelector(t):t,this.$=function(t){return n.root.querySelector(t)},this.$$=function(t){return n.root.querySelectorAll(t)},this.songList=[],this.currentIndex=0,this.audio=new Audio,this.start(),this.bind(),this.lyricsArr=[],this.lyricIndex=-1}return r(e,[{key:"start",value:function(){var t=this;fetch("https://wwfstrong.github.io/wwf-data/huawei/music-list.json").then(function(t){return t.json()}).then(function(e){t.songList=e,t.renderSong()})}},{key:"bind",value:function(){var e=this;this.$(".btn-play-pause").onclick=function(){this.classList.contains("playing")?(e.audio.pause(),this.classList.remove("playing"),this.classList.add("pause")):this.classList.contains("pause")&&(e.audio.play(),this.classList.remove("pause"),this.classList.add("playing"))},this.$(".btn-loop").onclick=function(){e.audio.currentTime=0},this.$(".btn-prev").onclick=function(){e.currentIndex=(e.songList.length+e.currentIndex-1)%e.songList.length,e.renderSong(),e.playSong()},this.$(".btn-next").onclick=function(){e.currentIndex=(e.currentIndex+1)%e.songList.length,e.renderSong(),e.playSong()},this.audio.ontimeupdate=function(){e.locateLyric(),e.setProgerssBar()};var i=new t.default(this.$(".panels"));i.on("swipLeft",function(){this.classList.remove("panel1"),this.classList.add("panel2"),e.$(".balls .sp-1").classList.remove("current"),e.$(".balls .sp-2").classList.add("current")}),i.on("swipRight",function(){this.classList.remove("panel2"),this.classList.add("panel1"),e.$(".balls .sp-1").classList.add("current"),e.$(".balls .sp-2").classList.remove("current")})}},{key:"renderSong",value:function(){var t=this,e=this.songList[this.currentIndex];this.$(".header h1").innerText=e.title,this.$(".header p").innerText=e.author+" - "+e.albumn,this.audio.src=e.url,this.audio.onloadedmetadata=function(){return t.$(".time-end").innerText=t.formateTime(t.audio.duration)},this.loadLyric()}},{key:"playSong",value:function(){var t=this;this.$(".btn-play-pause").classList.remove("pause"),this.$(".btn-play-pause").classList.add("playing"),this.audio.oncanplaythrough=function(){return t.audio.play()}}},{key:"loadLyric",value:function(){var t=this;fetch(this.songList[this.currentIndex].lyric).then(function(t){return t.json()}).then(function(e){console.log(e.lyric),t.setLyrics(e.lyric),window.lyrics=e.lyric})}},{key:"locateLyric",value:function(){if(1e3*this.audio.currentTime>this.lyricsArr[this.lyricIndex+1][0]&&this.lyricIndex<this.lyricsArr.length-1){this.lyricIndex++;var t=this.$('[data-time="'+this.lyricsArr[this.lyricIndex][0]+'"]');t&&this.setLyricToCenter(t),this.$$(".panel-effect .lyric p")[0].innerText=this.lyricsArr[this.lyricIndex][1],this.$$(".panel-effect .lyric p")[1].innerText=this.lyricsArr[this.lyricIndex+1]?this.lyricsArr[this.lyricIndex+1][1]:""}}},{key:"setLyrics",value:function(t){this.lyricIndex=0;var e=document.createDocumentFragment(),i=[];this.lyricsArr=i,t.split(/\n/).filter(function(t){return t.match(/\[.+?\]/)}).forEach(function(t){var e=t.replace(/\[.+?\]/g,"");t.match(/\[.+?\]/g).forEach(function(t){t=t.replace(/[\[\]]/g,"");var n=60*parseInt(t.slice(0,2))*1e3+1e3*parseInt(t.slice(3,5))+parseInt(t.slice(6));i.push([n,e])})}),i.filter(function(t){return""!==t[1].trim()}).sort(function(t,e){return t[0]>e[0]?1:-1}).forEach(function(t){var i=document.createElement("p");i.setAttribute("data-time",t[0]),i.innerText=t[1],e.appendChild(i)}),this.$(".panel-lyrics .container").innerHTML="",this.$(".panel-lyrics .container").appendChild(e)}},{key:"setLyricToCenter",value:function(t){var e=t.offsetTop;this.$(".panels .container").style.transform="translateY(-".concat(e,"px)"),this.$$(".panels .container p").forEach(function(t){return t.classList.remove("current")}),t.classList.add("current")}},{key:"setProgerssBar",value:function(){var t=100*this.audio.currentTime/this.audio.duration+"%";this.$(".bar .progress").style.width=t,this.$(".time-start").innerText=this.formateTime(this.audio.currentTime)}},{key:"formateTime",value:function(t){var e=parseInt(t/60);e=e>=10?""+e:"0"+e;var i=parseInt(t%60);return e+":"+(i=i>=10?""+i:"0"+i)}}]),e}();window.p=new s("#player");
},{"./swiper.js":"OCOi"}]},{},["EWR2"], null)
//# sourceMappingURL=javascript.2d0cd357.js.map